<div class="container">
  <form action="" #form="ngForm" (ngSubmit)="salvar(form)">

    <div class="grid">
      <div class="col-12">
        <h1>Novo Lançamento</h1>
      </div>
      <div class="md:col-12 ">
        <p-selectButton [options]="tipos" #tipo name="tipo" [(ngModel)]="lancamento.tipo"></p-selectButton>
      </div><br><br>
      <div class="p-fluid field col-12 md:col-3">
        <span class="p-float-label"><!-- [inline]="false" [readonlyInput]="false" [showIcon]="false" -->
          <p-calendar 
            dateFormat="mm/yy" 
            [readonlyInput]="true" 
            [monthNavigator]="true" 
            [yearNavigator]="true" 
            yearRange="2000:2030"
            id="inputtext" 
            name="dataVencimento" [(ngModel)]="lancamento.dataVencimento"
            ngModel #vencimento="ngModel"></p-calendar>
          <label for="inputtext">Vencimento</label>
      </span>
      <app-message [control]="vencimento" error="required" text="Informe uma descrição"></app-message>
      </div>
      <div class="p-fluid field col-12 md:col-3">
        <span class="p-float-label">
          <p-calendar 
            dateFormat="dd/mm/yy" 
            [(ngModel)]="lancamento.dataPagamento" 
            name="dataPagamento" 
            [readonlyInput]="true"
            [monthNavigator]="true" 
            [yearNavigator]="true" 
            yearRange="2000:2030"></p-calendar>
          <label for="inputtext">{{tipo.value === 'RECEITA' ? 'Recebimento' : 'Pagamento'}}</label>
      </span>
      </div>
      <div class="p-fluid field col-12 md:col-9">
        <span class="p-float-label">
          <input type="text" id="inputtext" pInputText name="descricao"
          ngModel #descricao="ngModel" required minlength="5" [(ngModel)]="lancamento.descricao" >
          <label for="inputtext">Descrição</label>
        </span>
        <app-message [control]="descricao" error="required" text="Informe uma descrição"></app-message>
        <app-message [control]="descricao" error="minlength"
        text="Mínimo de {{descricao.errors?.minlength?.requiredLength}} caracteres"></app-message>
        <!-- <p-message severity="error" text="Informe uma descrição"
        *ngIf="descricao.hasError('required') && descricao.dirty"></p-message> -->
        <!-- <p-message severity="error" text="Mínimo de {{descricao.errors?.minlength.requiredLength}} caracteres"
        *ngIf="descricao.hasError('minlength') && descricao.dirty"></p-message> -->
      </div>
      <div class="p-fluid field col-12 md:col-3" style="margin-top: -33px;">
        <!-- <span class="p-float-label"> -->
          <label for="inputtext">Valor</label>
          <p-inputNumber mode="currency" currency="BRL" locale="pt-BR"
          name="valor" ngModel #valor="ngModel" [(ngModel)]="lancamento.valor"></p-inputNumber>
        <!-- </span> -->
        <app-message [control]="valor" error="required" text="Informe uma descrição"></app-message>
      </div>
      <div class="p-fluid field col-12 md:col-6">
        <span class="p-float-label">
          <p-dropdown inputId="dropdown" [autoDisplayFirst]="false"  [options]="categorias"
          name="categoria" ngModel #categoria="ngModel" [(ngModel)]="lancamento.categoria">
          </p-dropdown>
          <label for="inputtext">Categoria</label>
          <!-- {{ lancamento.categoria }} -->
      </span>
      <app-message [control]="categoria" error="required" text="Informe uma descrição"></app-message>
      </div>
      <div class="p-fluid field col-12 md:col-6">
        <span class="p-float-label">
          <p-dropdown inputId="dropdown" [autoDisplayFirst]="false"  [options]="pessoas"
          [filter]="true" name="pessoa" ngModel #pessoa="ngModel" [(ngModel)]="lancamento.pessoa">
          </p-dropdown>
          <label for="inputtext">Pessoa</label>
      </span>
      <app-message [control]="pessoa" error="required" text="Informe uma descrição"></app-message>
      </div>
      <div class="p-fluid field col-12 md:col-12 ">
        <span class="p-float-label">
            <textarea 
              inputId="textarea" rows="3" 
              class="p-fluid" style="resize: none;"  name="observacao"
              cols="187" pInputTextarea [(ngModel)]="lancamento.observacao"></textarea>
            <label for="textarea">Observação</label>
        </span>
     </div>

    </div>
    <div class="grid">
      <div class="field col-12 md:col-12">
        <button pButton 
          type="submit" 
          pTooltip="Voltar" 
          tooltipPosition="top" 
          icon="fa-solid fa-arrow-left"
          routerLink="/lancamentos">
        </button>
        <button pButton type="submit" pTooltip="Salvar" tooltipPosition="top" icon="fas fa-save">
        </button>
        <button pButton icon="fas fa-eraser" type="button"
         pTooltip="Limpar" class="botao" (click)="limpar()"></button>
      </div>
    </div>


  </form>
</div>
